cmake_minimum_required(VERSION 3.0.0)
cmake_policy(SET CMP0048 NEW)
PROJECT(Orangutan
  DESCRIPTION
  "Orangutan"
  LANGUAGES
  CXX
  VERSION
  "1.0.0"
  )

set(CMAKE_MODULE_PATH ${PROJECT_SOURCE_DIR}/cmake)

set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++17 -Wall -g3")

# Generate compilation database for YouCompleteMe
set( CMAKE_EXPORT_COMPILE_COMMANDS ON )

# Make include root directory
include_directories(${PROJECT_SOURCE_DIR}/include)

set(glm_DIR ${PROJECT_SOURCE_DIR}/ext/glm)
find_package(glm REQUIRED)
set(GLM_LIBRARY glm::glm)

# Disable building extras we won't need (pure C++ project)
set(NANOGUI_BUILD_EXAMPLES OFF CACHE BOOL " " FORCE)
set(NANOGUI_BUILD_PYTHON  OFF CACHE BOOL " " FORCE)
set(NANOGUI_INSTALL       OFF CACHE BOOL " " FORCE)

# Add the configurations from nanogui
add_subdirectory(ext/nanogui)

# Various preprocessor definitions have been generated by NanoGUI
add_definitions(${NANOGUI_EXTRA_DEFS})

# On top of adding the path to nanogui/include, you may need extras
include_directories(${NANOGUI_EXTRA_INCS})

# For reliability of parallel build, make the NanoGUI targets dependencies
set_property(TARGET glfw glfw_objects nanogui PROPERTY FOLDER "dependencies")

find_package(SOIL REQUIRED)
include_directories( ${SOIL_INCLUDE_DIR} )

find_package(LIBPNG REQUIRED)
include_directories( ${LIBPNG_INCLUDE_DIR} )

set(CMAKE_CXX_LINK_EXECUTABLE "${CMAKE_CXX_LINK_EXECUTABLE} -lGL")

link_directories(
  /usr/local/lib
  /opt/local/lib
  ${SOIL_LIB_DIRS}
  ${LIBPNG_LIB_DIRS}
  )

set(LIBS
  ${LIBS}
  ${GLM_LIBRARY}
  nanogui
  ${NANOGUI_EXTRA_LIBS}
  ${SOIL_LIBRARY}
  ${LIBPNG_LIBRARY}
  )

file (GLOB APPSRCFILES src/app/*.cc)
file (GLOB CORESRCFILES src/core/*.cc)
file (GLOB CORESHADERSRCFILES src/core/shader/*.cc)
file (GLOB CORETEXTURESRCFILES src/core/texture/*.cc)
file (GLOB COREBUFFERSRCFILES src/core/buffer/*.cc)
file (GLOB COREVERTEXSRCFILES src/core/vertex/*.cc)
file (GLOB OBJECTSRCFILES src/object/*.cc)
file (GLOB CAMERASRCFILES src/camera/*.cc)
file (GLOB PHYSICSSRCFILES src/physics/*.cc)
file (GLOB SCENESRCFILES src/scene/*.cc)
file (GLOB SHADERSRCFILES src/shader/*.cc)
file (GLOB UTILSRCFILES src/util/*.cc)
file (GLOB MODELSRCFILES src/model/*.cc)
file (GLOB PRESENTERSRCFILES src/presenter/*.cc)
file (GLOB VIEWSRCFILES src/view/*.cc)

set(SRCFILES
  ${VIEWSRCFILES}
  ${CORESHADERSRCFILES}
  ${CORETEXTURESRCFILES}
  ${COREBUFFERSRCFILES}
  ${COREVERTEXSRCFILES}
  ${APPSRCFILES}
  ${CORESRCFILES}
  ${OBJECTSRCFILES}
  ${PATTERNSRCFILES}
  ${CAMERASRCFILES}
  ${PHYSICSSRCFILES}
  ${SCENESRCFILES}
  ${SHADERSRCFILES}
  ${UTILSRCFILES}
  ${MODELSRCFILES}
  ${PRESENTERSRCFILES}
  )

add_executable(Orangutan ${SRCFILES})

target_link_libraries(Orangutan ${LIBS})
